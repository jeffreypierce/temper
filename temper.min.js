(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F={}.hasOwnProperty,G=function(a,b){function c(){this.constructor=a}for(var d in b)F.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};E={type:function(a){var b;return void 0===a||null===a?!1:(b={"[object Number]":"number","[object String]":"string","[object Array]":"array","[object Object]":"object"},b[toString.call(a)])},normalize:function(a,b){var c;return null==b&&(b=3),c=Math.pow(10,b),Math.round(a*c)/c},list:function(a,b){var c,d,e,f,g,h;if(a&&this[a])return this[a];if(b){for(g=[],e=0,f=this.length;f>e;e++)d=this[e],g.push(d);return g}h=[];for(c in this)h.push(c);return h},centOffset:function(a,b){return Math.round(1200*Math.log(a/b)/Math.log(2))},ratioFromCents:function(a){return Math.pow(2,a/100/12)},stepRatio:Math.log(Math.pow(2,1/12))},y=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],z=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],r=["C","F","Bb","Eb","Ab","Db","Gb","Cb"],x={C:"B#",E:"E#",F:"E3",B:"Cb"},h=function(){function a(a,b){var c,d,e=this;"undefined"!=typeof window&&null!==window&&(this._play=b.play,this._pluck=b.pluck),this.rootFrequency=b.rootFrequency(),this.temperament=b._temperament,d=function(b){var c;if(c=/([A-Ga-g])([b#]?)(\d+)/.exec(b),null!=c)return e.octave=parseInt(c[3],10),e.accidental=c[2],e.letter=c[1].toUpperCase(),null!=e.accidental&&(e.letter+=e.accidental),e.frequency=E.normalize(e.getFrequencyFromNoteLetter()),e.name=a;throw new TypeError("Note name "+b+" is not a valid argument")},c=function(a){if(3e4>a&&a>0)return e.octave=Math.floor(Math.log(a/e.rootFrequency)/Math.log(2)),e.frequency=E.normalize(a),e.letter=e.getNoteLetterFromFrequency(),e.name=e.letter+e.octave.toString(),e.accidental=null!=e.name.match(/[b#]/)?e.name.match(/[b#]/):"";throw new RangeError("Frequency "+a+" is not valid")},"string"===E.type(a)&&d(a),"number"===E.type(a)&&c(a),this.midiNote=Math.round(12*Math.log(this.frequency/440)/Math.log(2)+69)}return a.prototype.getNoteArray=function(a){return r.indexOf(a)>-1?y:z},a.prototype.getNoteLetterFromFrequency=function(){var a,b,c;return a=Math.log(this.frequency/this.referenceFrequency()),c=Math.round(a/E.stepRatio),12===c&&(this.octave+=1),b=this.getNoteArray(this.letter),b[c%12]},a.prototype.getFrequencyFromNoteLetter=function(){var a,b,c;return a=this.getNoteArray(this.letter),b=a.indexOf(this.letter),c=E.ratioFromCents(D[this.temperament][b]),E.normalize(c*this.referenceFrequency())},a.prototype.referenceFrequency=function(){return this.rootFrequency*Math.pow(2,this.octave)},a}(),"undefined"!=typeof window&&null!==window&&(h.prototype.play=function(a){return this._play.call(this,a)},h.prototype.pluck=function(a){return this._pluck.call(this,a)}),n="U",t="m2",d="M2",u="m3",e="M3",j="P4",q="d5",k="P5",v="m6",f="M6",w="m7",g="M7",i="O",s=[n,t,d,u,e,j,q,k,v,f,w,g,i],c=function(a){function b(a,c,d,e){var f,g,h=this;this.direction=null!=d?d:"up",this.tonic=c.tonic,g=function(a,b){var c,d,e,f,g;return h.intervalName=a,g=s.indexOf(a),f=h.tonic.getNoteArray(),e=parseInt(b,10)||h.tonic.octave,"up"===h.direction?(d=f.indexOf(h.tonic.letter)+g,null==b&&d>=12&&(e+=1)):"down"===h.direction&&(d=f.indexOf(h.tonic.letter)-g,0>d&&(d+=12,null==b&&(e-=1))),c=f[d%12]+e.toString()},f=function(){var a,b,c,d,e;return e=h.getNoteArray.call(h.tonic),a=h.getNoteArray(),d=e.indexOf(h.tonic.letter),b=a.indexOf(h.letter),h.direction="down",c=(12-b+d)%12,(h.tonic.octave<h.octave||h.tonic.octave===h.octave&&b>d)&&(d>b&&(b+=12),c=b-d,h.direction="up"),s[c]},s.indexOf(a)>-1&&(a=g(a,e)),b.__super__.constructor.call(this,a,c),E.type(this.intervalName)||(this.intervalName=f()),this.tonic.name===this.name&&(this.direction="-"),this.frequencies=[this.tonic.frequency,this.frequency],this.names=[this.tonic.name,this.name],this.midiNotes=[this.tonic.midiNote,this.midiNote]}return G(b,a),b}(h),"undefined"!=typeof window&&null!==window&&(c.prototype.play=function(a){return this._play.call(this,a,2),this._play.call(this.tonic,a,2)},c.prototype.pluck=function(a){return this._pluck.call(this,a,2),this._pluck.call(this.tonic,a,2)}),b=function(){function a(a,b,d){var e,f,g,h,i,j,k=this;for(this.tonic=b.tonic,this.notes=[],this.name="unknown","undefined"!=typeof window&&null!==window&&(this._play=b.play,this._pluck=b.pluck),g=function(a){var e,f,g,h,i;if(d[a]){for(k.name=a,h=d[a],i=[],f=0,g=h.length;g>f;f++)e=h[f],i.push(k.notes.push(new c(e,b)));return i}throw new TypeError("Name "+a+" is not a valid argument")},f=function(a){var e,f,g,h,i,j,l,m,n,o,p,q;for(m=[],g=o=0,p=a.length;p>o;g=++o)j=a[g],j.indexOf(",")>-1?(e=j.split(","),j=e[0].trim(),f=e[1].trim(),l=e[2].trim(),h=new c(j,b,f,l)):h=new c(j,b),m.push(h.intervalName),k.notes.push(h);q=[];for(i in d){if(n=d[i],JSON.stringify(n)===JSON.stringify(m)){k.name=i;break}q.push(void 0)}return q},"string"===E.type(a)&&g(a),"array"===E.type(a)&&f(a),this.frequencies=[this.tonic.frequency],this.names=[this.tonic.name],this.midiNotes=[this.tonic.midiNote],j=this.notes,h=0,i=j.length;i>h;h++)e=j[h],this.frequencies.push(e.frequency),this.names.push(e.name),this.midiNotes.push(e.midiNote)}return a}(),o={maj:[e,k],maj6:[e,k,f],maj7:[e,k,g],majb6:[e,k,v],majb7:[e,k,w],min6:[u,k,v],min7:[u,k,w],minM7:[u,k,g],min:[u,k],aug:[e,v],aug7:[e,v,g],dim:[u,q],dim7:[u,q,f],sus4:[j,k],sus2:[d,k],dream:[j,q,k]},a=function(a){function b(a,c){b.__super__.constructor.call(this,a,c,o)}return G(b,a),b}(b),"undefined"!=typeof window&&null!==window&&(a.prototype.play=function(a){var b,c,d,e,f,g=this;for(this._play.call(this.tonic,a,this.notes.length+1),e=this.notes,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(function(b){return g._play.call(b,a,g.notes.length+1)}(b));return f},a.prototype.pluck=function(a){var b,c,d,e,f,g=this;for(this._pluck.call(this.tonic,a,this.notes.length+1),e=this.notes,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(function(b){return g._pluck.call(b,a,g.notes.length+1)}(b));return f}),B={Major:[d,e,j,k,f,g,i],"Melodic Minor":[d,u,j,k,v,w,i],"Harmonic Minor":[d,u,j,k,v,g],Chromatic:[t,d,u,e,j,q,k,v,f,w,g,i],Ionian:[d,e,j,k,f,g,i],Dorian:[d,u,j,k,f,w,i],Phrygian:[t,u,j,k,v,w,i],Lydian:[d,e,A4,k,f,g,i],Mixolydian:[d,e,j,k,f,w,i],Aeolian:[d,u,j,k,v,w,i],Locrian:[t,u,j,q,v,w,i],"Whole Tone":[d,e,q,v,w,i],Acoustic:[d,e,q,k,f,w,i],Enigmatic:[t,e,q,v,w,g,i],"Enigmatic Minor":[t,u,q,k,w,g,i],Neapolitan:[t,u,j,j,k,v,g,i],Prometheus:[d,e,q,f,w,i],"In Sen":[t,j,k,w,i],In:[t,j,k,v,i],Hirajoshi:[t,j,k,v,i],Yo:[d,j,k,f,i],Iwato:[t,j,q,w,i],Pentatonic:[d,e,k,f,i],"Octatonic I":[d,u,j,q,v,f,g,i],"Octatonic II":[t,u,e,q,k,f,w,i],Tritone:[t,e,q,k,w,i],Hungarian:[d,u,q,k,v,g,i]},l=function(a){function b(a,c){b.__super__.constructor.call(this,a,c,B)}return G(b,a),b}(b),"undefined"!=typeof window&&null!==window&&(l.prototype.play=function(a){var b,c,d,e,f,g,h=this;for(null==a&&(a=1),this._play.call(this.tonic,a,3),f=this.notes,g=[],b=d=0,e=f.length;e>d;b=++d)c=f[b],g.push(function(c){return setTimeout(function(){return h._play.call(c,a,3)},1e3*a/2*(b+1))}(c));return g},l.prototype.pluck=function(a){var b,c,d,e,f,g,h=this;for(null==a&&(a=1),this._pluck.call(this.tonic,a,3),f=this.notes,g=[],b=d=0,e=f.length;e>d;b=++d)c=f[b],g.push(function(c){return setTimeout(function(){return h._pluck.call(c,a,3)},1e3*a/2*(b+1))}(c));return g}),D={Equal:[0,100,200,300,400,500,600,700,800,900,1e3,1100,1200],Pythagorean:[0,113.69,203.91,294.13,407.82,498.04,611.73,701.95,815.64,905.87,996.09,1109.78,120],Natural:[0,111.74,203.91,315.64,386.31,498.05,603,702,813.69,884.36,1017.6,1088.27,1200],"1/3 comma Meantone":[0,63.5,189.57,315.64,379.14,505.21,568.72,694.79,758.29,884.36,1010.43,1073.93,1200],"2/7 comma Meantone":[0,70.67,191.62,312.57,383.24,504.19,574.86,695.81,766.48,887.43,1008.38,1079.05,1200],"1/4 comma Meantone":[0,76.05,193.16,310.26,386.31,503.42,579.47,696.58,772.63,889.74,1006.84,1082.89,1200],"1/5 comma Meantone":[0,83.58,195.31,307.04,390.61,502.35,585.92,697.65,781.23,892.96,1004.69,1088.27,1200],"1/6 comma Meantone":[0,88.59,196.74,304.89,393.48,501.63,590.22,698.37,786.96,895.11,1003.26,1091.85,1200],"1/8 comma Meantone":[0,94.87,198.53,302.2,397.07,500.73,595.6,699.27,794.13,897.8,1001.47,1096.33,1200],Ordinaire:[0,86.81,193.16,296.09,386.31,503.42,584.85,696.58,788.76,889.74,1005.22,1082.89,1200],"Werckmeister III":[0,90.22,192.18,294.14,390.23,498.05,588.27,696.09,792.18,888.27,996.09,1092.18,1200],Kirnberger:[0,91,192,296,387,498,591,696,792,890,996,1092,1200],"Kirnberger III":[0,90.18,193.16,294.13,386.31,498.04,590.22,696.58,792.18,889.74,996.09,1088.27,1200],Young:[0,93.69,195.91,298.13,391.82,502.04,591.73,697.96,796.18,893.87,1000.09,1089.78,1200]},D["1/11 comma Meantone"]=D.Equal,D.Salinas=D["1/3 comma Meantone"],D.Aaron=D["1/4 comma Meantone"],D.Silbermann=D["1/5 comma Meantone"],m=function(){function b(a,b,c){this.tuningFrequency=null!=b?b:440,this._temperament=null!=c?c:"Equal",null!=a&&(this.tonic=new h(a,this))}return b.prototype.rootFrequency=function(){var a;return a=E.ratioFromCents(D[this._temperament][9]),this.tuningFrequency/Math.pow(2,4)/a},b.prototype.note=function(a){return null!=a?this.tonic=new h(a,this):this.tonic},b.prototype.temperament=function(a){return null!=a?(D[a]&&(this._temperament=a,this.note(this.tonic.name),this._interval&&this.interval(this._interval.name)),this):this._temperament},b.prototype.interval=function(a,b,d){return null!=a?this._interval=new c(a,this,b,d):this._interval},b.prototype.scale=function(a){return null!=a?this._scale=new l(a,this):this._scale},b.prototype.chord=function(b){return null!=b?this._chord=new a(b,this):this._chord},b}(),A=this,C=function(a,b,c){return new m(a,b,c)},C.note=function(a){return new m(a)},C.tonic=function(a){return new m(a)},C.chords=function(a){return E.list.call(o,a)},C.intervals=function(a){return E.list.call(s,a,!0)},C.temperaments=function(a){return E.list.call(D,a)},C.centOffset=E.centOffset,"undefined"!=typeof exports?module.exports=C:A.temper=C,"undefined"!=typeof window&&null!==window&&(window.AudioContext=window.AudioContext||window.webkitAudioContext,p=new AudioContext,m.prototype.play=function(a,b){var c,d,e,f,g;return null==a&&(a=2),null==b&&(b=1),g=.9/b,c=p.currentTime,d=c+a,e=p.createOscillator(),e.type="sine",e.frequency.value=this.frequency?this.frequency:this.tonic.frequency,f=p.createGain(),f.gain.setValueAtTime(0,c),f.gain.linearRampToValueAtTime(g,d-.5*a),f.gain.linearRampToValueAtTime(0,d),e.connect(f),f.connect(p.destination),e.start(c),e.stop(d)},m.prototype.pluck=function(a,b){var c,d,e,f,g,h,i,j,k;return null==a&&(a=2),null==b&&(b=1),j=.9/b,d=p.currentTime,e=d+a,k=function(a){var b,c,d,e,f,g,h,i,j;for(f=[],i=new Float32Array(p.sampleRate),g=Math.floor(p.sampleRate/a),d=0;g>d;)f[d]=2*Math.random()-1,d++;for(h=0,j=function(){var a,b;return a=f.shift(),b=(a+h)/2,h=b,f.push(b),b},b=.5*Math.random()+.4,e=0;e<p.sampleRate;)i[e]=j(),c=b-e/p.sampleRate*b,i[e]=i[e]*c,e++;return i},i=p.createGain(),g=p.createBufferSource(),f=this.frequency?this.frequency:this.tonic.frequency,h=k(f),c=p.createBuffer(1,h.length,p.sampleRate),c.getChannelData(0).set(h),g.buffer=c,g.connect(i),i.connect(p.destination),i.gain.value=j,g.start(d),g.stop(e)})}).call(this);