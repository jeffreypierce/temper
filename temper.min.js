(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};o={},o.type=function(a){var b;return void 0===a||null===a?!1:(b={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},b[Object.prototype.toString.call(a)])},j=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],k=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],i={C:"B#",E:"E#",F:"E3",B:"Cb"},p=function(a){return Math.round(1e3*a)/1e3},c=function(){function a(a,b){var c,d,e=this;"undefined"!=typeof window&&null!==window&&(this._play=b.play,this._pluck=b.pluck),this.rootFrequency=b.rootFrequency(),this.temperament=b._temperament,d=function(b){var c;if(c=/([A-Ga-g])([b#]?)(\d+)/.exec(b),null!=c)return e.octave=parseInt(c[3],10),e.accidental=c[2],e.letter=c[1].toUpperCase(),null!=e.accidental&&(e.letter+=e.accidental),e.frequency=p(e.getFrequencyFromNoteLetter()),e.name=a;throw new TypeError('Note name "'+b+'" is not a valid argument')},c=function(a){if(3e4>a&&a>0)return e.octave=Math.floor(Math.log(a/e.rootFrequency)/Math.log(2)),e.frequency=p(a),e.letter=e.getNoteLetterFromFrequency(),e.name=e.letter+e.octave.toString(),e.accidental=null!=e.name.match(/[b#]/)?e.name.match(/[b#]/):"";throw new RangeError('Frequency "'+a+'" is not valid')},o.type("string"===a)&&d(a),o.type("number"===a)&&c(a)}return a.prototype.getNoteArray=function(){var a;return a="#"===this.accidental?k:j},a.prototype.getNoteLetterFromFrequency=function(){var a,b,c,d;return a=Math.log(this.frequency/this.referenceFrequency()),d=Math.log(Math.pow(2,1/12)),b=Math.round(a/d),12===b&&(this.octave+=1),c=this.getNoteArray(),c[b%12]},a.prototype.getFrequencyFromNoteLetter=function(){var a,b;return a=this.getNoteArray(),b=a.indexOf(this.letter),p(n[this.temperament][b]*this.referenceFrequency())},a.prototype.referenceFrequency=function(){return this.rootFrequency*Math.pow(2,this.octave)},a}(),"undefined"!=typeof window&&null!==window&&(c.prototype.play=function(a){return this._play.call(this,a)},c.prototype.pluck=function(a){return this._pluck.call(this,a)}),g=["U","m2","M2","m3","M3","P4","d5","P5","m6","M6","m7","M7","O"],h=["unison","minor second","major second","minor third","major third","perfect fourth","diminished fifth","perfect fifth","minor sixth","major sixth","minor seventh","major seventh","octave"],b=function(a){function b(a,c,d){var e,f,h=this;this.direction=null!=d?d:"up",this.rootNote=c._note,f=function(a){var b,c,d,e,f;return h.intervalName=a,f=g.indexOf(a),e=h.rootNote.getNoteArray(),d=h.rootNote.octave,"up"===h.direction?(c=e.indexOf(h.rootNote.letter)+f,c>=12&&(d+=1)):"down"===h.direction&&(c=e.indexOf(h.rootNote.letter)-f,0>c&&(d-=1,c+=12)),b=e[c%12]+d.toString()},e=function(){var a,b,c,d,e;return e=h.getNoteArray.call(h.rootNote),a=h.getNoteArray(),d=e.indexOf(h.rootNote.letter),b=a.indexOf(h.letter),h.direction="down",c=(12-b+d)%12,(h.rootNote.octave<h.octave||h.rootNote.octave===h.octave&&b>d)&&(d>b&&(b+=12),c=b-d,h.direction="up"),g[c]},g.indexOf(a)>=0&&(a=f(a)),b.__super__.constructor.call(this,a,c),o.type(this.intervalName)&&(this.intervalName=e()),this.rootNote.name===this.name&&(this.direction="-")}return r(b,a),b}(c),"undefined"!=typeof window&&null!==window&&(b.prototype.play=function(a){return this._play.call(this,a),this._play.call(this.rootNote,a)},b.prototype.pluck=function(a){return this._pluck.call(this,a),this._pluck.call(this.rootNote,a)}),e={major:["M3","P5"],minor:["m3","P5"],augmented:["M3","m6"],diminished:["m3","d5"]},a=function(){function a(a,c){var d,f,h=this;"undefined"!=typeof window&&null!==window&&(this._play=c.play,this._pluck=c.pluck),this.notes=[],this.name="unknown",f=function(a){var d,f,i,j,k;if(e[a]){for(h.name=a,j=e[a],k=[],f=0,i=j.length;i>f;f++)d=j[f],k.push(h.notes.push(new b(g[d],c)));return k}throw new TypeError('Chord name "'+a+'" is not a valid argument')},d=function(a){var d,f,i,j,k,l,m,n,o;for(d=[],f=m=0,n=a.length;n>m;f=++m)k=a[f],i=new b(k,c),d.push(g.indexOf(i.intervalName)),h.notes.push(i);o=[];for(j in e){if(l=e[j],JSON.stringify(l)===JSON.stringify(d)){h.name=j;break}o.push(void 0)}return o},"string"===o.type(a)&&f(a),"array"===o.type(a)&&d(a)}return a}(),"undefined"!=typeof window&&null!==window&&(a.prototype.play=function(a){var b,c,d,e,f,g=this;for(e=this.notes,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(function(b){return g._play.call(b,a)}(b));return f},a.prototype.pluck=function(a){var b,c,d,e,f,g=this;for(e=this.notes,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(function(b){return g._pluck.call(b,a)}(b));return f}),n={pythagorian:[1,256/243,9/8,32/27,81/64,4/3,1024/729,1.5,128/81,27/16,16/9,243/128,2],just:[1,16/15,9/8,1.2,5/4,4/3,1.4,1.5,1.6,5/3,7/4,15/8,2],equal:[1,1.05946,1.12246,1.18921,1.25992,1.33483,1.41421,1.49831,1.5874,1.68179,1.7818,1.88775,2],meantone:[1,1.07,1.118,1.1963,1.25,1.3375,1.4311,1.4953,1.6,1.6719,1.7889,1.8692,2]},d=function(){function d(a,b,d){this._tuningFrequency=null!=b?b:440,this._temperament=null!=d?d:"equal",a&&(this._note=new c(a,this))}return d.prototype.rootFrequency=function(){return this._tuningFrequency/Math.pow(2,4)/n[this._temperament][9]},d.prototype.note=function(a){return null!=a?this._note=new c(a,this):this._note},d.prototype.temperament=function(a){return null!=a?(n[a]&&(this._temperament=a,this.note(this._note.name),this._interval&&this.interval(this._interval.name)),this):this._temperament},d.prototype.interval=function(a,c){return null!=a?this._interval=new b(a,this,c):this._interval},d.prototype.scale=function(){},d.prototype.chord=function(b){return null!=b?this._chord=new a(b,this):this._chord},d}(),l=this,m=function(a,b,c){return new d(a,b,c)},m.note=function(a){return new d(a)},m.centOffset=function(a,b){return Math.round(1200*Math.log(a/b)/Math.log(2))},"undefined"!=typeof exports?module.exports=m:l.temper=m,"undefined"!=typeof window&&null!==window&&(f=new window.webkitAudioContext,d.prototype.play=function(a,b){var c,d,e,g;return null==a&&(a=2),null==b&&(b=.8),c=f.currentTime,d=c+a,e=f.createOscillator(),e.type="sine",e.frequency.value=this.frequency?this.frequency:this._note.frequency,g=f.createGainNode(),g.gain.setValueAtTime(0,c),g.gain.linearRampToValueAtTime(b,d-.5*a),g.gain.linearRampToValueAtTime(0,d),e.connect(g),g.connect(f.destination),e.start(c),e.stop(d),this},d.prototype.pluck=function(a,b){var c,d,e,g,h,i,j,k;return null==a&&(a=2),null==b&&(b=.8),d=f.currentTime,e=d+a,k=function(a){var b,c,d,e,g,h,i,j,k;for(g=[],j=new Float32Array(f.sampleRate),h=Math.floor(f.sampleRate/a),d=0;h>d;)g[d]=2*Math.random()-1,d++;for(i=0,k=function(){var a,b;return a=g.shift(),b=(a+i)/2,i=b,g.push(b),b},b=.5*Math.random()+.4,e=0;e<f.sampleRate;)j[e]=k(),c=b-e/f.sampleRate*b,j[e]=j[e]*c,e++;return j},j=f.createGainNode(),h=f.createBufferSource(),g=this.frequency?this.frequency:this._note.frequency,i=k(g),c=f.createBuffer(1,i.length,f.sampleRate),c.getChannelData(0).set(i),h.buffer=c,h.connect(j),j.connect(f.destination),j.gain.value=b,h.start(d),h.stop(e),this})}).call(this);